{
  "openapi": "3.1.0",
  "info": {
    "title": "Interface doubao-seedream-4.5",
    "description": "Créer des tâches d'images en utilisant des modèles IA, prenant en charge plusieurs modèles et configurations de paramètres",
    "license": {
      "name": "MIT"
    },
    "version": "1.0.0"
  },
  "servers": [
    {
      "url": "https://api.evolink.ai",
      "description": "Environnement de production"
    }
  ],
  "security": [
    {
      "bearerAuth": []
    }
  ],
  "paths": {
    "/v1/images/generations": {
      "post": {
        "summary": "Interface doubao-seedream-4.5",
        "description": "- Le modèle Seedream 4.5 (doubao-seedream-4.5) prend en charge les modes texte-vers-image, image-vers-image, édition d'image et autres modes de génération\n- Mode de traitement asynchrone, utilisez l'ID de tâche retourné pour [interroger](/fr/api-manual/task-management/get-task-detail)\n- Les liens d'image générés sont valides pendant 24 heures, veuillez les enregistrer rapidement",
        "operationId": "createImageGeneration",
        "tags": [
          "Génération d'image"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ImageGenerationRequest"
              },
              "examples": {
                "text_to_image": {
                  "summary": "Texte vers image",
                  "value": {
                    "model": "doubao-seedream-4.5",
                    "prompt": "A serene lake reflecting the beautiful sunset"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Tâche de génération d'image créée avec succès",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ImageGenerationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Paramètres de requête invalides",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "error": {
                    "code": 400,
                    "message": "Paramètres de requête invalides",
                    "type": "invalid_request_error"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Non authentifié, jeton invalide ou expiré",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "error": {
                    "code": 401,
                    "message": "Invalid or expired token",
                    "type": "authentication_error"
                  }
                }
              }
            }
          },
          "402": {
            "description": "Quota insuffisant, recharge requise",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "error": {
                    "code": 402,
                    "message": "Quota insuffisant",
                    "type": "insufficient_quota_error",
                    "fallback_suggestion": "https://evolink.ai/dashboard/billing"
                  }
                }
              }
            }
          },
          "403": {
            "description": "Accès refusé",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "error": {
                    "code": 403,
                    "message": "Access denied for this model",
                    "type": "permission_error",
                    "param": "model"
                  }
                }
              }
            }
          },
          "404": {
            "description": "Ressource introuvable",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "error": {
                    "code": 404,
                    "message": "Specified model not found",
                    "type": "not_found_error",
                    "param": "model",
                    "fallback_suggestion": "doubao-seedream-4.5"
                  }
                }
              }
            }
          },
          "413": {
            "description": "Corps de la requête trop volumineux",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "error": {
                    "code": 413,
                    "message": "Image file too large",
                    "type": "request_too_large_error",
                    "param": "image_urls",
                    "fallback_suggestion": "compress image to under 4MB"
                  }
                }
              }
            }
          },
          "429": {
            "description": "Limite de débit dépassée",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "error": {
                    "code": 429,
                    "message": "Limite de débit dépassée",
                    "type": "rate_limit_error",
                    "fallback_suggestion": "retry after 60 seconds"
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erreur interne du serveur",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "error": {
                    "code": 500,
                    "message": "Erreur interne du serveur",
                    "type": "internal_server_error",
                    "fallback_suggestion": "try again later"
                  }
                }
              }
            }
          },
          "502": {
            "description": "Erreur du service en amont",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "error": {
                    "code": 502,
                    "message": "Upstream AI service unavailable",
                    "type": "upstream_error",
                    "fallback_suggestion": "try different model"
                  }
                }
              }
            }
          },
          "503": {
            "description": "Service temporairement indisponible",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "error": {
                    "code": 503,
                    "message": "Service temporairement indisponible",
                    "type": "service_unavailable_error",
                    "fallback_suggestion": "retry after 30 seconds"
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "ImageGenerationRequest": {
        "type": "object",
        "required": [
          "model",
          "prompt"
        ],
        "properties": {
          "model": {
            "type": "string",
            "description": "Nom du modèle de génération d'image",
            "enum": [
              "doubao-seedream-4.5"
            ],
            "default": "doubao-seedream-4.5",
            "example": "doubao-seedream-4.5"
          },
          "prompt": {
            "type": "string",
            "description": "Invite décrivant l'image que vous souhaitez générer, ou décrivant comment éditer l'image d'entrée, limitée à 2000 tokens",
            "example": "A serene lake reflecting the beautiful sunset",
            "maxLength": 2000
          },
          "n": {
            "type": "integer",
            "description": "Nombre maximum d'images à générer, prend en charge toute valeur entière entre `[1,15]`\n\n**Remarque :**\n- Pour générer plusieurs images, incluez des prompts comme : \"générer 2 images différentes\" dans votre prompt\n\n- Nombre d'images de référence + nombre d'images générées finales ≤ 15 images\n\n- Si : nombre d'images de référence + images demandées dans le prompt > 15, et images demandées dans le prompt ≤ valeur du paramètre n, alors images générées finales = 15 - nombre d'images de référence\n- Chaque requête sera pré-facturée en fonction de la valeur de `n`, facturation réelle basée sur le nombre d'images générées",
            "example": 1
          },
          "size": {
            "type": "string",
            "description": "Taille de l'image générée, prend en charge deux formats :\n\n**Méthode 1 - Format simplifié :**\n- `2K`, `4K`\n- Décrivez le rapport d'aspect/forme/objectif dans le prompt, le modèle déterminera automatiquement la taille optimale\n\n**Méthode 2 - Format pixel :**\n- Largeur x Hauteur, par exemple : `2560x1440`, `2048x2048`, `4096x4096` et autres valeurs dans la plage\n- Par défaut : `2048x2048`\n- Plage de pixels totale : `[2560x1440, 4096x4096]`\n- Plage de rapport d'aspect : `[1/16, 16]`",
            "example": "2048x2048"
          },
          "prompt_priority": {
            "type": "string",
            "description": "Stratégie d'optimisation d'invite, utilisée pour définir le mode d'optimisation d'invite\n\n**Options :**\n- `standard` : Mode standard, sortie de meilleure qualité, temps de traitement plus long",
            "enum": [
              "standard"
            ],
            "default": "standard",
            "example": "standard"
          },
          "image_urls": {
            "type": "array",
            "description": "Liste d'URL d'images de référence pour les fonctionnalités image vers image et édition d'image\n\n**Remarque :**\n- Une seule requête prend en charge la quantité d'images d'entrée : `14` images\n- Taille d'image : pas plus de `10MB`\n- Formats d'image pris en charge : `.jpeg`, `.jpg`, `.png`, `.webp`, `.bmp`, `.tiff`, `.gif`\n- Plage de rapport d'aspect (largeur/hauteur) : `[1/16, 16]`\n- Largeur et hauteur (px) > 14\n- Total de pixels : pas plus de `6000×6000`\n- Les URL d'images doivent être directement visibles par le serveur, ou l'URL de l'image doit déclencher un téléchargement direct lors de l'accès (généralement ces URL se terminent par des extensions de fichiers image, telles que `.png`, `.jpg`)",
            "items": {
              "type": "string",
              "format": "uri"
            },
            "maxItems": 14,
            "example": [
              "https://example.com/image1.png",
              "https://example.com/image2.png"
            ]
          },
          "callback_url": {
            "type": "string",
            "description": "Adresse de rappel HTTPS après l'achèvement de la tâche\n\n**Moment du rappel :**\n- Déclenché lorsque la tâche est terminée, échouée ou annulée\n- Envoyé après confirmation de la facturation\n\n**Restrictions de sécurité :**\n- Seul le protocole HTTPS est pris en charge\n- Les rappels vers les adresses IP internes sont interdits (127.0.0.1, 10.x.x.x, 172.16-31.x.x, 192.168.x.x, etc.)\n- La longueur de l'URL ne doit pas dépasser `2048` caractères\n\n**Mécanisme de rappel :**\n- Délai d'expiration : `10` secondes\n- Maximum `3` tentatives en cas d'échec (tentatives après `1` seconde/`2` secondes/`4` secondes)\n- Le format du corps de réponse du rappel est cohérent avec le format de réponse de l'API de requête de tâche\n- Un code de statut 2xx renvoyé par l'adresse de rappel est considéré comme un succès, les autres codes de statut déclenchent une nouvelle tentative",
            "format": "uri",
            "example": "https://your-domain.com/webhooks/image-task-completed"
          }
        }
      },
      "ImageGenerationResponse": {
        "type": "object",
        "properties": {
          "created": {
            "type": "integer",
            "description": "Horodatage de création de la tâche",
            "example": 1757165031
          },
          "id": {
            "type": "string",
            "description": "ID de tâche",
            "example": "task-unified-1757165031-seedream4d"
          },
          "model": {
            "type": "string",
            "description": "Nom du modèle réellement utilisé",
            "example": "doubao-seedream-4.5"
          },
          "object": {
            "type": "string",
            "enum": [
              "image.generation.task"
            ],
            "description": "Type de tâche spécifique"
          },
          "progress": {
            "type": "integer",
            "description": "Pourcentage de progression de la tâche (0-100)",
            "minimum": 0,
            "maximum": 100,
            "example": 0
          },
          "status": {
            "type": "string",
            "description": "Statut de la tâche",
            "enum": [
              "pending",
              "processing",
              "completed",
              "failed"
            ],
            "example": "pending"
          },
          "task_info": {
            "$ref": "#/components/schemas/TaskInfo",
            "description": "Informations sur la tâche asynchrone"
          },
          "type": {
            "type": "string",
            "enum": [
              "text",
              "image",
              "audio",
              "video"
            ],
            "description": "Type de sortie de la tâche",
            "example": "image"
          },
          "usage": {
            "$ref": "#/components/schemas/Usage",
            "description": "Informations d'utilisation et de facturation"
          }
        }
      },
      "TaskInfo": {
        "type": "object",
        "properties": {
          "can_cancel": {
            "type": "boolean",
            "description": "Si la tâche peut être annulée",
            "example": true
          },
          "estimated_time": {
            "type": "integer",
            "description": "Temps d'achèvement estimé (secondes)",
            "minimum": 0,
            "example": 45
          }
        }
      },
      "Usage": {
        "type": "object",
        "description": "Informations d'utilisation et de facturation",
        "properties": {
          "billing_rule": {
            "type": "string",
            "description": "Règle de facturation",
            "enum": [
              "per_call",
              "per_token",
              "per_second"
            ],
            "example": "per_call"
          },
          "credits_reserved": {
            "type": "number",
            "description": "Crédits estimés consommés",
            "minimum": 0,
            "example": 1.8
          },
          "user_group": {
            "type": "string",
            "description": "Catégorie de groupe d'utilisateurs",
            "example": "default"
          }
        }
      },
      "ErrorResponse": {
        "type": "object",
        "properties": {
          "error": {
            "type": "object",
            "properties": {
              "code": {
                "type": "integer",
                "description": "Code d'erreur de statut HTTP"
              },
              "message": {
                "type": "string",
                "description": "Description de l'erreur"
              },
              "type": {
                "type": "string",
                "description": "Type d'erreur"
              },
              "param": {
                "type": "string",
                "description": "Nom du paramètre concerné"
              },
              "fallback_suggestion": {
                "type": "string",
                "description": "Solution suggérée"
              }
            }
          }
        }
      }
    },
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "description": "##Toutes les API nécessitent une authentification Bearer Token##\n\n**Obtenir une clé API :**\n\nVisitez la [Page de gestion des clés API](https://evolink.ai/dashboard/keys) pour obtenir votre clé API\n\n**Ajouter à l'en-tête de requête :**\n```\nAuthorization: Bearer YOUR_API_KEY\n```"
      }
    }
  },
  "tags": [
    {
      "name": "Génération d'image",
      "description": "APIs liées à la génération d'images IA"
    }
  ]
}